version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo Installing dependencies...
        - cd frontend
        - npm ci
    build:
      commands:
        - echo Build started on `date`
        - echo Compiling code
        - node -v
        # - export RESEND_API_KEY=$(aws ssm get-parameter --name /amplify/$AWS_APP_ID/$AWS_BRANCH/RESEND_KEY --with-decryption --query "Parameter.Value" --output text)
        - npm run build
    postBuild:
      commands:
        - cd .next
        - ls
  artifacts:
    baseDirectory: /frontend/out
    files:
      - "**/*"
  cache:
    paths:
      - node_modules/**/* # Cache `node_modules` for faster `yarn` or `npm i`
      - .next/cache/**/* # Cache Next.js for faster application rebuilds
